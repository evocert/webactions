!function(name,context,definition){typeof exports=='object'?module.exports=definition(require):typeof define=='function'&&define.amd?define(definition):context[name]=definition()}.call(this,'parseActivePassive',this,function(require){function parseActivePassive(prsng,unparsedcontent){var trimcode,passive,unsprsdln,psvprsdi,atvprsdi,canprintout,owner,print,altFlushPassive,altFlushPassiveResult,altFlushActive,altFlushActiveResult,altEvalActive,stillvalid,foundCode,hasCode,tmppassive,tmpcode,code,prvc,begi,endi,content;typeof prsng.startParsing=="function"&&prsng.startParsing(),trimcode=!(typeof prsng.trimactive=="boolean")||prsng.trimactive,passive="",unsprsdln=-1,psvprsdi=-1,atvprsdi=-1,canprintout=typeof prsng.print=="function",owner=typeof prsng.owner=="object"?prsng.owner:null,print=function(prntthis){canprintout&&typeof prntthis=="string"&&prntthis!==""&&(passive+=prntthis)},altFlushPassive=typeof prsng.flushpassive=="function"?prsng.flushpassive:null,altFlushPassiveResult=null,altFlushActive=typeof prsng.flushactive=="function"?prsng.flushactive:null,altFlushActiveResult=null,altEvalActive=typeof prsng.evalactive=="function"?prsng.evalactive:null,stillvalid=!0;function iterateString(prsgn,stringtoiterate,functoprsr){var i,tmpstringtoiterate;if(stillvalid&&stringtoiterate!=null)if(typeof stringtoiterate=="string"&&typeof functoprsr=="function"){for(i=0;i<stringtoiterate.length;i++)if(unsprsdln++,functoprsr(prsgn,stringtoiterate[i]),!stillvalid)break}else if(typeof stringtoiterate=="function")for(tmpstringtoiterate=null;stillvalid;)if((tmpstringtoiterate=stringtoiterate())!=null&&typeof tmpstringtoiterate=="string"){for(i=0;i<tmpstringtoiterate.length;i++)if(unsprsdln++,functoprsr(prsgn,tmpstringtoiterate[i]),!stillvalid)break}else break}foundCode=!1,hasCode=!1,tmppassive="",tmpcode="",code="",prvc="",begi=0,endi=0,content=[],typeof prsng.beglbl!="string"&&(prsng.beglbl="[@"),typeof prsng.endlbl!="string"&&(prsng.endlbl="@]");function flushPassive(prsng){if(tmppassive!=""){if(altFlushPassive!=null&&typeof altFlushPassive=="function")(altFlushPassiveResult=altFlushPassive(tmppassive,psvprsdi))!=null&&typeof altFlushPassiveResult=="boolean"&&altFlushPassiveResult===!1&&(stillvalid=!1);else if(foundCode)if(tmppassive.length>1&&tmppassive.startsWith("|'|")&&tmppassive.endsWith("|'|"))tmpcode+="print("+tmppassive+");";else{var cntntl=content.push(tmppassive+"");tmpcode+="print(content["+(cntntl-1)+"]);"}else print(tmppassive);psvprsdi>-1&&(psvprsdi=-1),tmppassive=""}}function parsePsvChar(prsng,chr){flushCode(prsng),tmppassive+=chr}function parseCodeChar(prsng,chr){hasCode||(trimcode&&(chr+"").trim()!==""?hasCode=!0:hasCode=!0),hasCode&&(flushPassive(prsng),foundCode||(foundCode=!0),tmpcode+=chr)}function flushCode(prsgn){tmpcode!=""&&(altFlushActive!=null&&typeof altFlushActive=="function"?(altFlushActiveResult=altFlushActive(tmpcode,atvprsdi))!=null&&typeof altFlushActiveResult=="boolean"&&altFlushActiveResult===!1&&(stillvalid=!1):code+=tmpcode,atvprsdi>-1&&(atvprsdi=-1),tmpcode="")}function parsechr(prsng,chr){var bi;endi==0&&begi<prsng.beglbl.length?(psvprsdi==-1&&(psvprsdi=unsprsdln),begi>0&&prsng.beglbl[begi-1]==prvc&&prsng.beglbl[begi]!==chr&&(bi=begi,begi=0,iterateString(prsng,prsng.beglbl.substring(0,bi),parsePsvChar)),prsng.beglbl[begi]===chr?(begi++,begi===prsng.beglbl.length?(prvc="",prvc=""):prvc=chr):(begi>0&&(bi=begi,begi=0,iterateString(prsng,prsng.beglbl.substring(0,bi),parsePsvChar)),parsePsvChar(prsng,prvc=chr))):begi==prsng.beglbl.length&&endi<prsng.endlbl.length&&(atvprsdi==-1&&(atvprsdi=unsprsdln),prsng.endlbl[endi]===chr?(endi++,endi===prsng.endlbl.length&&(begi=0,endi=0,prvc="")):(endi>0&&(bi=endi,endi=0,iterateString(prsng,prsng.endlbl.substring(0,bi),parseCodeChar)),parseCodeChar(prsng,chr)))}iterateString(prsng,unparsedcontent,parsechr),flushPassive(prsng),flushCode(prsng),foundCode&&code!=""&&(altEvalActive!=null&&typeof altEvalActive=="function"?altEvalActive(code):eval(code)),passive!==""&&canprintout&&prsng.print(passive),typeof prsng.endParsing=="function"&&prsng.endParsing()}return parseActivePassive})