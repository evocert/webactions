function webactionRequestViaOptions(e,r,t,a,s){postForm({url_ref:e,form_ref:r,target:t,command:a,enable_progress_elem:null==s?"true":s})}var lasturlref="";function postElem(){var e=[].slice.call(arguments);if(null!=e){if(Array.isArray(e)){if(0==e.length)return;if(1!=e.length){for(var r in e)postElem(e[r]);return}e=e[0]}var t={};$(e).each(function(){$.each(this.attributes,function(){this.specified&&("url_ref"==this.name||"form_ref"==this.name||"enable_progress_elem"==this.name||"progress_elem"==this.name||"target"==this.name||"command"==this.name||"scriptlabel"==this.name||"replacelabel"==this.name?t[this.name]=this.value:"json_ref"==this.name&&null!=this.value&&""!=this.value&&(t[this.name]=JSON.parse(this.value)))})}),postNode(t)}}function postNode(){var e=[].slice.call(arguments);if(null!=e){if(Array.isArray(e)){if(0==e.length)return;if(1!=e.length){for(var r in e)postNode(e[r]);return}if(Array.isArray(e[0])){for(var r in e[0])postNode(e[0][r]);return}if("function"==typeof e[0]){var t=e[0]();if(void 0===t)return;return void postNode(t)}e=e[0]}if(null!=e.url_ref&&""!=e.url_ref){var a=!1,s=!1;null!=e.enable_progress_elem&&""!=e.enable_progress_elem&&(s="true"==e.enable_progress_elem);var l="",n=!1,i="",o="",p="",d="";null!=e.command&&""!=e.command&&(d=e.command),null!=e.form_ref&&""!=e.form_ref&&(a=!0,p=e.form_ref);var h=null;null!=e.json_ref&&(n=!0,h=e.json_ref);s&&(null!=e.progress_elem?l=e.progress_elem+"":($.blockUI({message:'<span style="font-size:1.2em" id="showprogress">Please wait ...</span>',css:{border:"none",padding:"15px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.7,color:"#fff"}}),l="#showprogress"),null!=l&&"#showprogress"!=l&&$(l).show()),i=null!=e.error_elem?(e.error_elem+"").trim():"",o=null!=e.url_ref?e.url_ref+(e.url_ref+"").trim():(lasturlref+"").trim(),a&&null!=e.form_ref&&(p=(e.form_ref+"").trim()),null!=e.target&&(e.target+"").trim();var c=n?h:new FormData;if(""!==o){var f=getAllUrlParams(o);o.indexOf("?")>-1?(o=o.slice(0,o.indexOf("?")),lasturlref=o+""):lasturlref=o+"",null!=f&&Object.keys(f).forEach(function(e){Array.isArray(f[e])?f[e].forEach(function(r){n?(null==c["reqst-params"][fname]&&(c["reqst-params"][fname]=[]),c["reqst-params"][e].push(r)):c.append(e,r)}):n?(null==c["reqst-params"][fname]&&(c["reqst-params"][fname]=[]),c["reqst-params"][e].push(f[e])):c.append(e,f[e])})}var u=""==p.trim()?[]:p.split("|");a&&u.forEach(function(e,r,t){$(e).length&&($(e).is("form")||null!=$(e).find("select[name],input[name],textarea[name]")&&$(e).find("select[name],input[name],textarea[name]").each(function(){var e=$(this);if(""!=e.attr("name")){var r=!0,t=void 0!==e.attr("type")?e.attr("type"):"text";if("checkbox"!==t&&"radio"!==t||(r=!!e.prop("checked")),r){var a=e.attr("name"),s=e.val();n&&null==c["reqst-params"]&&(c["reqst-params"]={}),void 0!==t&&"button"!==t&&"submit"!==t&&"image"!==t&&"file"===t?n||c.append(e.attr("name"),e[0].files[0]):n?(null==c["reqst-params"][a]&&(c["reqst-params"][a]=[]),c["reqst-params"][a].push(s)):c.append(a,s)}}}))}),""!=d&&(hasJSon||c.append("command",d));var m=defaultResponseCall,b=defaultResponseErrorCall;new Promise(function(r,t){$.ajax({xhr:function(){var e=$.ajaxSettings.xhr();return e.upload.onprogress=function(e){s&&null!=l&&""!=l&&$(l).html(Math.floor(e.loaded/e.total*100)+"%")},e.withCredentials=!1,e},contentType:!!n&&"application/json",processData:!1,type:"POST",data:n?JSON.stringify(c):c,url:o,success:function(a,n,i){if(null==i.getResponseHeader("Content-Disposition")){s&&null!=l&&("#showprogress"==l?$.unblockUI():$(l).hide());var o="replace-content";null!=e.replacelabel&&""!==(""!=e.replacelabel).trim()&&(o=(""!=e.replacelabel).trim());var p="script";if(null!=e.scriptlabel&&""!=e.scriptlabel!==""&&(p=""!=e.scriptlabel),null!=m){null==e.replacelabel&&(e.replacelabel=o),null==e.scriptlabel&&(e.scriptlabel=p);try{m("ajax",e,a,n,i),r()}catch(e){t(e)}}}else{var d=(""+i.getResponseHeader("Content-Disposition")).trim();d.indexOf("attachment;")>-1&&(d=d.substr(d.indexOf("attachment;")+"attachment;".length).trim());var h=(""+i.getResponseHeader("Content-Type")).trim();h.indexOf(";")>-1&&(h=h.substr(0,h.indexOf(";")).trim()),d.indexOf("filename=")>-1&&(d=(d=(d=d.substr(d.indexOf("filename=")+"filename=".length).trim()).replace(/"/i,"")).replace(/"/i,"")),safeData(responseText,d,h)}},error:function(r,a,n){s&&null!=l&&("#showprogress"==l?$.unblockUI():$(l).hide()),void 0!==b?b("ajax",e,a,r):null!=i&&""!=i&&$(i).html("Error loading request: "+a),t(Error("Error loading request: "+a))}})}).then(function(){null!=e.resolved&&"function"==typeof e.resolved&&e.resolved(e),null!=e.options&&postNode(e.options)},function(r){null!=e.rejected&&"function"==typeof e.rejected&&e.rejected(e,r)})}}}function defaultResponseCall(){var args=[].slice.call(arguments);if(args.length>=4){var options=args[1],scriptlablel=options.scriptlabel+"",replacelabel=options.replacelabel+"",response=args[2],parsed=parseActiveString(`${scriptlabel}||`,`||${scriptlabel}`,response),parsedScript=parsed[1].join("");response=parsed[0].trim();var targets=[],targetSections=[];if(""!=response&&(response.indexOf(`${replacelabel}||`)>-1&&(parsed=parseActiveString(`${replacelabel}||`,`||${replacelabel}`,response),response=parsed[0],parsed[1].forEach(function(e,r){e.indexOf("||")>-1&&(targets[targets.length]=[e.substring(0,e.indexOf("||")),e.substring(e.indexOf("||")+"||".length,e.length)])})),targets.unshift([target,response])),targets.length>0&&targets.forEach(function(e){$(e[0]).length>0&&(e[0].startsWith("#")?$(e[0]).html(e[1]):$(e[0]).each(function(r){$(this).html(e[1])}))}),""!=parsedScript)try{eval(parsedScript)}catch(e){throw e}}}function defaultResponseErrorCall(){[].slice.call(arguments)}function safeData(e,r,t){var a=document.createElement("a");document.body.appendChild(a),a.style="display: none",blob=new Blob([e],{type:t}),url=window.URL.createObjectURL(blob),a.href=url,a.download=r,a.click(),window.URL.revokeObjectURL(url)}function parseActiveString(e,r,t){return this.parsedPassiveString="",this.parsedActiveString="",this.parsedActiveArr=[],this.passiveStringIndex=0,this.passiveStringArr=Array.from(t),this.passiveStringLen=this.passiveStringArr.length,this.labelStartIndex=0,this.labelEndIndex=0,this.labelStartArr=Array.from(e),this.labelEndArr=Array.from(r),this.pc="",this.passiveStringArr.forEach(function(t,a){0==this.labelEndIndex&&this.labelStartIndex<this.labelStartArr.length?(this.labelStartIndex>0&&this.labelStartArr[this.labelStartIndex-1]==pc&&this.labelStartArr[this.labelStartIndex]!=t&&(this.parsedPassiveString+=e.substring(0,this.labelStartIndex),this.labelStartIndex=0),this.labelStartArr[this.labelStartIndex]==t?(this.labelStartIndex++,this.labelStartIndex,this.labelStartArr.length):(this.labelStartindex>0&&(this.parsedPassiveString+=e.substring(0,this.labelStartIndex),this.labelStartIndex=0),this.parsedPassiveString+=t+"")):this.labelStartIndex==this.labelStartArr.length&&this.labelEndIndex<this.labelEndArr.length&&(this.labelEndArr[this.labelEndIndex]==t?(this.labelEndIndex++,this.labelEndIndex==this.labelEndArr.length&&(this.parsedActiveArr[this.parsedActiveArr.length]=this.parsedActiveString+"",this.parsedActiveString="",this.labelEndIndex=0,this.labelStartIndex=0)):(this.labelEndIndex>0&&(this.parsedActiveString+=r.substring(0,this.labelEndIndex),this.labelEndIndex=0),this.parsedActiveString+=t+"")),this.pc=t}),[this.parsedPassiveString,this.parsedActiveArr]}function getAllUrlParams(e){var r=e?e.split("?")[1]:"",t={};if(r)for(var a=(r=r.split("#")[0]).split("&"),s=0;s<a.length;s++){var l=a[s].split("="),n=decodeURIComponent(l[0]),i=void 0===l[1]?"":decodeURIComponent(l[1]);if(n.match(/\[(\d+)?\]$/)){var o=n.replace(/\[(\d+)?\]/,"");if(t[o]||(t[o]=[]),n.match(/\[\d+\]$/)){var p=/\[(\d+)\]/.exec(n)[1];t[o][p]=i}else t[o].push(i)}else t[n]?t[n]&&"string"==typeof t[n]?(t[n]=[t[n]],t[n].push(i)):t[n].push(i):t[n]=i}return t}