function webactionRequestViaOptions(e,t,r,a,s){postForm({url_ref:e,form_ref:t,target:r,command:a,enable_progress_elem:null==s?"true":s})}var lasturlref="";function postElem(){var e=[].slice.call(arguments);if(null!=e){if(Array.isArray(e)){if(0==e.length)return;if(1!=e.length){for(var t in e)postElem(e[t]);return}e=e[0]}var r={};$(e).each(function(){$.each(this.attributes,function(){this.specified&&("url_ref"==this.name||"form_ref"==this.name||"enable_progress_elem"==this.name||"progress_elem"==this.name||"target"==this.name||"command"==this.name||"scriptlabel"==this.name||"replacelabel"==this.name||"activecontent"===this.name?r[this.name]=this.value:"json_ref"==this.name&&null!=this.value&&""!=this.value&&(r[this.name]=JSON.parse(this.value)))})}),postNode(r)}}function postNode(){var e=[].slice.call(arguments);if(null!=e){if(Array.isArray(e)){if(0==e.length)return;if(1!=e.length){for(var t in e)postNode(e[t]);return}if(Array.isArray(e[0])){for(var t in e[0])postNode(e[0][t]);return}if("function"==typeof e[0]){var r=e[0]();if(void 0===r)return;return void postNode(r)}e=e[0]}if(null!=e.url_ref&&""!=e.url_ref){var a=!1,s=!1;null!=e.enable_progress_elem&&""!=e.enable_progress_elem&&(s="true"==e.enable_progress_elem);var n="",l=!1,i="",o="",p="",c="";null!=e.command&&""!=e.command&&(c=e.command),null!=e.form_ref&&""!=e.form_ref&&(a=!0,p=e.form_ref);var d=null;null!=e.json_ref&&(l=!0,d=e.json_ref);s&&(null!=e.progress_elem?n=e.progress_elem+"":($.blockUI({message:'<span style="font-size:1.2em" id="showprogress">Please wait ...</span>',css:{border:"none",padding:"15px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.7,color:"#fff"}}),n="#showprogress"),null!=n&&"#showprogress"!=n&&$(n).show()),i=null!=e.error_elem?(e.error_elem+"").trim():"",o=null!=e.url_ref?(e.url_ref+"").trim():(lasturlref+"").trim(),a&&null!=e.form_ref&&(p=(e.form_ref+"").trim()),null!=e.target&&(e.target+"").trim();var h=l?d:new FormData;if(""!==o){var f=getAllUrlParams(o);o.indexOf("?")>-1?(o=o.slice(0,o.indexOf("?")),lasturlref=o+""):lasturlref=o+"",null!=f&&Object.keys(f).forEach(function(e){Array.isArray(f[e])?f[e].forEach(function(t){l?(null==h["reqst-params"][fname]&&(h["reqst-params"][fname]=[]),h["reqst-params"][e].push(t)):h.append(e,t)}):l?(null==h["reqst-params"][fname]&&(h["reqst-params"][fname]=[]),h["reqst-params"][e].push(f[e])):h.append(e,f[e])})}var u=""==p.trim()?[]:p.split("|");a&&u.forEach(function(e,t,r){$(e).length&&($(e).is("form")||null!=$(e).find("select[name],input[name],textarea[name]")&&$(e).find("select[name],input[name],textarea[name]").each(function(){var e=$(this);if(""!=e.attr("name")){var t=!0,r=void 0!==e.attr("type")?e.attr("type"):"text";if("checkbox"!==r&&"radio"!==r||(t=!!e.prop("checked")),t){var a=e.attr("name"),s=e.val();l&&null==h["reqst-params"]&&(h["reqst-params"]={}),void 0!==r&&"button"!==r&&"submit"!==r&&"image"!==r&&"file"===r?l||h.append(e.attr("name"),e[0].files[0]):l?(null==h["reqst-params"][a]&&(h["reqst-params"][a]=[]),h["reqst-params"][a].push(s)):h.append(a,s)}}}))}),""!=c&&(hasJSon||h.append("command",c));var m=defaultResponseCall,v=defaultResponseErrorCall;new Promise(function(t,r){$.ajax({xhr:function(){var e=$.ajaxSettings.xhr();return e.upload.onprogress=function(e){s&&null!=n&&""!=n&&$(n).html(Math.floor(e.loaded/e.total*100)+"%")},e.withCredentials=!1,e},contentType:!!l&&"application/json",processData:!1,type:"POST",data:l?JSON.stringify(h):h,url:o,success:function(a,l,i){if(null==i.getResponseHeader("Content-Disposition")){s&&null!=n&&("#showprogress"==n?$.unblockUI():$(n).hide());var o="replace-content";null!=e.replacelabel&&""!==(""!=e.replacelabel).trim()&&(o=(""!=e.replacelabel).trim());var p="script";if(null!=e.scriptlabel&&""!=e.scriptlabel!==""&&(p=""!=e.scriptlabel),null!=m){null==e.replacelabel&&(e.replacelabel=o),null==e.scriptlabel&&(e.scriptlabel=p);try{m("ajax",e,a,l,i),t()}catch(e){r(e)}}}else{var c=(""+i.getResponseHeader("Content-Disposition")).trim();c.indexOf("attachment;")>-1&&(c=c.substr(c.indexOf("attachment;")+"attachment;".length).trim());var d=(""+i.getResponseHeader("Content-Type")).trim();d.indexOf(";")>-1&&(d=d.substr(0,d.indexOf(";")).trim()),c.indexOf("filename=")>-1&&(c=(c=(c=c.substr(c.indexOf("filename=")+"filename=".length).trim()).replace(/"/i,"")).replace(/"/i,"")),safeData(responseText,c,d)}},error:function(t,a,l){s&&null!=n&&("#showprogress"==n?$.unblockUI():$(n).hide()),void 0!==v?v("ajax",e,a,t):null!=i&&""!=i&&$(i).html("Error loading request: "+a),r(Error("Error loading request: "+a))}})}).then(function(){null!=e.resolved&&"function"==typeof e.resolved&&e.resolved(e),null!=e.options&&postNode(e.options)},function(t){null!=e.rejected&&"function"==typeof e.rejected&&e.rejected(e,t)})}}}function defaultResponseCall(){var args=[].slice.call(arguments);if(args.length>=4){var options=args[1],target="";void 0!==options.target&&(target=options.target+"");var scriptlabel=options.scriptlabel+"",replacelabel=options.replacelabel+"",enableActivePassive="boolean"==typeof options.activecontent&&options.activecontent,response=args[2],parsed=parseActiveString(`${scriptlabel}||`,`||${scriptlabel}`,response),parsedScript=parsed[1].join("");response=parsed[0].trim();var targets=[],targetSections=[];if(""!=response&&response.indexOf(`${replacelabel}||`)>-1){parsed=parseActiveString(`${replacelabel}||`,`||${replacelabel}`,response),response=parsed[0];for(let e of parsed[1])e.indexOf("||")>-1&&(targets[targets.length]=[e.substring(0,e.indexOf("||")),e.substring(e.indexOf("||")+"||".length,e.length)])}if(""!==target&&""!==response&&(target.startsWith("#")?enableActivePassive&&"function"==typeof parseActivePassive?parseActivePassive({print:function(e){$(target).html(e)}},response):$(target).html(response):$(target).each(function(e){var t=this;enableActivePassive&&"function"==typeof parseActivePassive?parseActivePassive({print:function(e){$(t).html(e)}},targetSec[1]):$(this).html(response)})),targets.length>0&&targets.forEach(function(e){$(e[0]).length>0&&(e[0].startsWith("#")?enableActivePassive&&"function"==typeof parseActivePassive?parseActivePassive({print:function(t){$(e[0]).html(t)}},e[1]):$(e[0]).html(e[1]):$(e[0]).each(function(t){var r=this;enableActivePassive&&"function"==typeof parseActivePassive?parseActivePassive({print:function(e){$(r).html(e)}},e[1]):$(r).html(e[1])}))}),""!=parsedScript)try{eval(parsedScript)}catch(e){throw e}}}function defaultResponseErrorCall(){[].slice.call(arguments)}function safeData(e,t,r){var a=document.createElement("a");document.body.appendChild(a),a.style="display: none",blob=new Blob([e],{type:r}),url=window.URL.createObjectURL(blob),a.href=url,a.download=t,a.click(),window.URL.revokeObjectURL(url)}function parseActiveString(e,t,r){this.parsedPassiveString="",this.parsedActiveString="",this.parsedActiveArr=[],this.passiveStringIndex=0,this.passiveStringArr=[...r],this.labelStartIndex=0,this.labelEndIndex=0,this.labelStartArr=[...e],this.labelEndArr=[...t],this.pc="";for(let r of passiveStringArr)0==this.labelEndIndex&&this.labelStartIndex<this.labelStartArr.length?(this.labelStartIndex>0&&this.labelStartArr[this.labelStartIndex-1]==pc&&this.labelStartArr[this.labelStartIndex]!=r&&(this.parsedPassiveString+=e.substring(0,this.labelStartIndex),this.labelStartIndex=0),this.labelStartArr[this.labelStartIndex]==r?(this.labelStartIndex++,this.labelStartIndex,this.labelStartArr.length):(this.labelStartindex>0&&(this.parsedPassiveString+=e.substring(0,this.labelStartIndex),this.labelStartIndex=0),this.parsedPassiveString+=r+"")):this.labelStartIndex==this.labelStartArr.length&&this.labelEndIndex<this.labelEndArr.length&&(this.labelEndArr[this.labelEndIndex]==r?(this.labelEndIndex++,this.labelEndIndex==this.labelEndArr.length&&(this.parsedActiveArr[this.parsedActiveArr.length]=this.parsedActiveString+"",this.parsedActiveString="",this.labelEndIndex=0,this.labelStartIndex=0)):(this.labelEndIndex>0&&(this.parsedActiveString+=t.substring(0,this.labelEndIndex),this.labelEndIndex=0),this.parsedActiveString+=r+"")),this.pc=r;return[this.parsedPassiveString,this.parsedActiveArr]}function getAllUrlParams(e){var t=e?e.split("?")[1]:"",r={};if(t)for(var a=(t=t.split("#")[0]).split("&"),s=0;s<a.length;s++){var n=a[s].split("="),l=decodeURIComponent(n[0]),i=void 0===n[1]?"":decodeURIComponent(n[1]);if(l.match(/\[(\d+)?\]$/)){var o=l.replace(/\[(\d+)?\]/,"");if(r[o]||(r[o]=[]),l.match(/\[\d+\]$/)){var p=/\[(\d+)\]/.exec(l)[1];r[o][p]=i}else r[o].push(i)}else r[l]?r[l]&&"string"==typeof r[l]?(r[l]=[r[l]],r[l].push(i)):r[l].push(i):r[l]=i}return r}